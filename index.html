<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nigeria Tax Alert & Reminder System</title>
<style>
body{font-family:Segoe UI,Tahoma,Verdana,sans-serif;background:#eef1f6;margin:0;padding:20px}
.container{max-width:1100px;margin:auto;background:#fff;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.15)}
.header{background:#1e3c72;color:#fff;padding:25px;text-align:center;border-radius:12px 12px 0 0}
.content{padding:25px}
.form-section{background:#f9fafb;padding:20px;border-radius:10px;margin-bottom:25px}
label{display:block;margin:10px 0 5px;font-weight:600}
input,select{width:100%;padding:10px;border-radius:6px;border:1px solid #ccc}
.btn{margin-top:15px;padding:12px;width:100%;border:none;border-radius:8px;background:#667eea;color:#fff;font-weight:600;cursor:pointer}
.btn-secondary{background:#6c757d}
.btn-danger{background:#e53935}
.card{background:#fff;border-radius:8px;padding:15px;margin-bottom:10px;box-shadow:0 2px 6px rgba(0,0,0,.1)}
.dashboard{display:none}
.hidden{display:none}
.inline input{width:auto;margin-right:5px}
.small-btn{padding:6px 10px;font-size:12px;margin-right:5px}
</style>
</head>
<body>
<div class="container">
<div class="header">
<h1>ðŸ‡³ðŸ‡¬ Nigeria Tax Alert & Reminder System</h1>
<p>Singleâ€‘File Plug & Play Demo (WORKING)</p>
</div>
<div class="content">

<!-- AUTH -->
<div id="auth" class="form-section">
<h2>Register or Login</h2>
<label>Full Name</label>
<input id="fullName">
<label>Username</label>
<input id="username">
<label>Password</label>
<input id="password" type="password">
<label>Account Type</label>
<select id="role"><option value="user">Regular User</option><option value="admin">Admin</option></select>
<button class="btn" onclick="registerUser()">Register</button>
<button class="btn btn-secondary" onclick="loginUser()">Login</button>
</div>

<!-- ADMIN DASHBOARD -->
<div id="adminDash" class="dashboard">
<h2>Admin Dashboard</h2>
<div id="adminUsers"></div>
<button class="btn" onclick="logout()">Logout</button>
</div>

<!-- USER TAX SETUP -->
<div id="taxSetup" class="form-section hidden">
<h2>Tax Profile Setup</h2>
<label>Entity Type</label>
<select id="entity"><option value="company">Company</option><option value="small">Small Business</option><option value="individual">Individual</option></select>
<label>Taxes</label>
<div class="inline">
<input type="checkbox" id="CIT"> CIT
<input type="checkbox" id="PAYE"> PAYE
<input type="checkbox" id="PIT"> PIT
<input type="checkbox" id="VAT"> VAT
<input type="checkbox" id="WHT"> WHT
</div>
<label>Company Year End</label>
<input type="date" id="yearEnd">
<button class="btn" onclick="saveTaxProfile()">Save & View Dashboard</button>
</div>

<!-- USER DASHBOARD -->
<div id="userDash" class="dashboard"></div>

</div></div>

<script>
const USERS_KEY='TAX_USERS_V1';
const SESSION_KEY='TAX_SESSION_V1';

function getUsers(){return JSON.parse(localStorage.getItem(USERS_KEY)||'[]');}
function saveUsers(u){localStorage.setItem(USERS_KEY,JSON.stringify(u));}

function registerUser(){
 if(!username.value||!password.value)return alert('Fill all fields');
 let u=getUsers();
 if(u.find(x=>x.username===username.value))return alert('Username already exists');
 u.push({
  name:fullName.value,
  username:username.value,
  password:password.value,
  role:role.value,
  active:true,
  profile:null
 });
 saveUsers(u);
 alert('Registration successful. You can now login.');
}

function loginUser(){
 let u=getUsers().find(x=>x.username===username.value&&x.password===password.value&&x.active);
 if(!u)return alert('Invalid login or disabled account');
 localStorage.setItem(SESSION_KEY,u.username);
 loadSession();
}

function logout(){localStorage.removeItem(SESSION_KEY);location.reload();}

function loadSession(){
 let uname=localStorage.getItem(SESSION_KEY);
 if(!uname)return;
 let u=getUsers().find(x=>x.username===uname);
 auth.style.display='none';
 if(u.role==='admin'){
  adminDash.style.display='block';
  renderAdmin();
 }else{
  if(u.profile){showUser(u);}else{taxSetup.classList.remove('hidden');}
 }
}

function renderAdmin(){
 adminUsers.innerHTML=getUsers().map((u,i)=>
 `<div class='card'><b>${u.name||''}</b> (${u.username}) - ${u.role}<br>Status: ${u.active?'Active':'Disabled'}<br>
 <button class='small-btn' onclick='toggleUser(${i})'>Enable/Disable</button>
 <button class='small-btn btn-danger' onclick='deleteUser(${i})'>Delete</button></div>`).join('');
}

function toggleUser(i){let u=getUsers();u[i].active=!u[i].active;saveUsers(u);renderAdmin();}
function deleteUser(i){let u=getUsers();u.splice(i,1);saveUsers(u);renderAdmin();}

function saveTaxProfile(){
 let u=getUsers();
 let me=u.find(x=>x.username===localStorage.getItem(SESSION_KEY));
 let taxes=['CIT','PAYE','PIT','VAT','WHT'].filter(t=>document.getElementById(t).checked);
 if(taxes.length===0)return alert('Select at least one tax');
 me.profile={
  entity:entity.value,
  taxes,
  yearEnd:yearEnd.value,
  deadlines:taxes.map(t=>({tax:t,due:calcDueDate(t),completed:false}))
 };
 saveUsers(u);
 showUser(me);
}

function calcDueDate(tax){
 let d=new Date();
 d.setDate(d.getDate()+30);
 return d.toDateString();
}

function showUser(u){
 taxSetup.style.display='none';
 userDash.style.display='block';
 userDash.innerHTML=`<h2>${u.name} Dashboard</h2>`+
 u.profile.deadlines.map((d,i)=>
 `<div class='card'>${d.tax} â€“ Due: ${d.due}</div>`).join('')+
 `<button class='btn' onclick='logout()'>Logout</button>`;
}

window.onload=loadSession;
</script>
</body>
</html>
